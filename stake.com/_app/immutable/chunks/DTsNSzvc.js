import{o as g}from"./OQq7D5fM.js";import{o as y}from"./DsWglHr0.js";import{g as h}from"./C3Uqgz1j.js";import{c as O}from"./B_XU9Oa-.js";import{c}from"./CKTzCw_8.js";import{n as m}from"./_x0WFvrY.js";import{b as u}from"./BnZzCvUo.js";import{i as l}from"./-2c5L_R-.js";import{C as _}from"./BpphRAvc.js";const T=n=>g("registerOauth",n),A=n=>({title:l._("OAuth User Already Registered"),body:{id:"This email is already registered under the username {username}",values:n},icon:_}),d=600,f=600,q=({windowName:n="Connect With OAuth",url:t})=>{const s=screen.width/2-f/2,o=screen.height/2-d/2,r=`location=0, status=0, width=${f}, height=${d}, top=${o}, left=${s}`;return window.open(t,n,r)},x=async n=>{const{data:t,error:s,eventDispatcher:o,handlers:r}=n;if(s)if(Array.isArray(s)){const a=s[0];a!=null&&a.message&&m.open(c({message:a.message}))}else m.open(c({message:s.message}));const p=t&&"oauth"in t?t.oauth:t==null?void 0:t.oneTap;let i;if(p){const{result:e}=p;return(e==null?void 0:e.__typename)==="OauthTfa"&&(i="OauthTfa",u("loginToken",e.loginToken),y({tab:"login"}),o&&o("oauth",{type:"OauthTfa",loginToken:e.loginToken})),(e==null?void 0:e.__typename)==="UserAuthenticatedSession"&&(i="UserAuthenticatedSession",h.next({type:"authenticate",subtype:"login",userAuthenticatedSession:e}),h.next({type:"firstUserResponse",user:e.session.user}),o&&o("oauth",{type:"UserAuthenticatedSession"}),O()),(e==null?void 0:e.__typename)==="OauthRegister"&&(i="OauthRegister",u.set("identityId",e.identityId),T({email:e!=null&&e.requestEmail?"requested":"omit"}),o&&o("oauth",{type:"OauthRegister",identityId:e.identityId})),(e==null?void 0:e.__typename)==="OauthUserExists"&&m.open(A({username:e.user.name})),(e==null?void 0:e.__typename)==="OauthRequest"&&r.OauthRequest(e),i}};export{q as a,x as o};
