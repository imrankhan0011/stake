import{B as Wn,a as qn,e as Yn,f as Vn}from"./DRfdS80Y.js";const _={log:"log",debug:"debug",info:"info",warn:"warn",error:"error"},A=console,F={};Object.keys(_).forEach(e=>{F[e]=A[e]});const ae="Datadog Browser SDK:",y={debug:F.debug.bind(A,ae),log:F.log.bind(A,ae),info:F.info.bind(A,ae),warn:F.warn.bind(A,ae),error:F.error.bind(A,ae)},dt="https://docs.datadoghq.com",Xn=`${dt}/real_user_monitoring/browser/troubleshooting`,ft="More details:";function Gt(e,t){return(...n)=>{try{return e(...n)}catch(r){y.error(t,r)}}}function Oe(e){return e!==0&&Math.random()*100<=e}function Jn(e){return Qn(e)&&e>=0&&e<=100}function Qn(e){return typeof e=="number"}const oe=1e3,q=60*oe,jt=60*q,Zn=24*jt,er=365*Zn;function fe(){return new Date().getTime()}function U(){return fe()}function Ae(){return performance.now()}function k(){return{relative:Ae(),timeStamp:U()}}function tr(){return{relative:0,timeStamp:Kt()}}function Ht(e,t){return t-e}function nr(e,t){return e+t}function rr(e){return e-Kt()}let Ke;function Kt(){return Ke===void 0&&(Ke=performance.timing.navigationStart),Ke}const Z=1024,zt=1024*Z,or=/[^\u0000-\u007F]/;function Wt(e){return or.test(e)?window.TextEncoder!==void 0?new TextEncoder().encode(e).length:new Blob([e]).size:e.length}function sr(e){return{...e}}function qt(e,t){return Object.keys(e).some(n=>e[n]===t)}function Be(e){return Object.keys(e).length===0}function L(){if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"_dd_temp_",{get(){return this},configurable:!0});let e=_dd_temp_;return delete Object.prototype._dd_temp_,typeof e!="object"&&(typeof self=="object"?e=self:typeof window=="object"?e=window:e={}),e}function ee(e,t){const n=L();let r;return n.Zone&&typeof n.Zone.__symbol__=="function"&&(r=e[n.Zone.__symbol__(t)]),r||(r=e[t]),r}let ke,Yt=!1;function ir(e){ke=e}function cr(e){Yt=e}function ur(e,t,n){const r=n.value;n.value=function(...o){return(ke?h(r):r).apply(this,o)}}function h(e){return function(){return pe(e,this,arguments)}}function pe(e,t,n){try{return e.apply(t,n)}catch(r){Vt(r)}}function Vt(e){if(st(e),ke)try{ke(e)}catch(t){st(t)}}function st(...e){Yt&&y.error("[MONITOR]",...e)}function be(e,t){return ee(L(),"setTimeout")(h(e),t)}function Xt(e){ee(L(),"clearTimeout")(e)}function pt(e,t){return ee(L(),"setInterval")(h(e),t)}function Jt(e){ee(L(),"clearInterval")(e)}function wt(e){const t=window.queueMicrotask;typeof t=="function"?t(h(e)):Promise.resolve().then(h(e))}class E{constructor(t){this.onFirstSubscribe=t,this.observers=[]}subscribe(t){return this.addObserver(t),{unsubscribe:()=>this.removeObserver(t)}}notify(t){this.observers.forEach(n=>n(t))}addObserver(t){this.observers.push(t),this.observers.length===1&&this.onFirstSubscribe&&(this.onLastUnsubscribe=this.onFirstSubscribe(this)||void 0)}removeObserver(t){this.observers=this.observers.filter(n=>t!==n),!this.observers.length&&this.onLastUnsubscribe&&this.onLastUnsubscribe()}}function Qt(...e){return new E(t=>{const n=e.map(r=>r.subscribe(o=>t.notify(o)));return()=>n.forEach(r=>r.unsubscribe())})}class Zt extends E{constructor(t){super(),this.maxBufferSize=t,this.buffer=[]}notify(t){this.buffer.push(t),this.buffer.length>this.maxBufferSize&&this.buffer.shift(),super.notify(t)}subscribe(t){let n=!1;const r={unsubscribe:()=>{n=!0,this.removeObserver(t)}};return wt(()=>{for(const o of this.buffer){if(n)return;t(o)}n||this.addObserver(t)}),r}unbuffer(){wt(()=>{this.maxBufferSize=this.buffer.length=0})}}function ar(e,t,n){let r=!1,o,s;return{throttled:(...i)=>{if(r){o=i;return}e(...i),r=!0,s=be(()=>{o&&e(...o),r=!1,o=void 0},t)},cancel:()=>{Xt(s),r=!1,o=void 0}}}function D(){}function B(e){return e?(parseInt(e,10)^Math.random()*16>>parseInt(e,10)/4).toString(16):`10000000-1000-4000-8000-${1e11}`.replace(/[018]/g,B)}const Le=/([\w-]+)\s*=\s*([^;]+)/g;function lr(e,t){for(Le.lastIndex=0;;){const n=Le.exec(e);if(n){if(n[1]===t)return n[2]}else break}}function dr(e){const t=new Map;for(Le.lastIndex=0;;){const n=Le.exec(e);if(n)t.set(n[1],n[2]);else break}return t}function fr(e,t,n=""){const r=e.charCodeAt(t-1),s=r>=55296&&r<=56319?t+1:t;return e.length<=s?e:`${e.slice(0,s)}${n}`}var Ne;(function(e){e.TRACK_INTAKE_REQUESTS="track_intake_requests",e.WRITABLE_RESOURCE_GRAPHQL="writable_resource_graphql",e.WATCH_COOKIE_WITHOUT_LOCK="watch_cookie_without_lock"})(Ne||(Ne={}));const gt=new Set;function pr(e){Array.isArray(e)&&gr(e.filter(t=>qt(Ne,t)))}function gr(e){e.forEach(t=>{gt.add(t)})}function mr(e){return gt.has(e)}function br(){return gt}function hr(){return yr()===0}let Ee;function yr(){return Ee??(Ee=Sr())}function Sr(e=window){var t;const n=e.navigator.userAgent;return e.chrome||/HeadlessChrome/.test(n)?0:((t=e.navigator.vendor)===null||t===void 0?void 0:t.indexOf("Apple"))===0||/safari/i.test(n)&&!/chrome|android/i.test(n)?1:2}function Fe(e,t,n=0,r){const o=new Date;o.setTime(o.getTime()+n);const s=`expires=${o.toUTCString()}`,i=r&&r.crossSite?"none":"strict",c=r&&r.domain?`;domain=${r.domain}`:"",u=r&&r.secure?";secure":"",a=r&&r.partitioned?";partitioned":"";document.cookie=`${e}=${t};${s};path=/;samesite=${i}${c}${u}${a}`}function mt(e){return lr(document.cookie,e)}let ze;function H(e){return ze||(ze=dr(document.cookie)),ze.get(e)}function en(e,t){Fe(e,"",0,t)}function Er(e){if(document.cookie===void 0||document.cookie===null)return!1;try{const t=`dd_cookie_test_${B()}`,n="test";Fe(t,n,q,e);const r=mt(t)===n;return en(t,e),r}catch(t){return y.error(t),!1}}let We;function tn(){if(We===void 0){const e=`dd_site_test_${B()}`,t="test",n=window.location.hostname.split(".");let r=n.pop();for(;n.length&&!mt(e);)r=`${n.pop()}.${r}`,Fe(e,t,oe,{domain:r});en(e,{domain:r}),We=r}return We}const he="_dd_s";function Pe(e){return Object.values(e)}function _r(e){return Object.entries(e)}const bt=4*jt,nn=15*q,Cr=er,rn="0",ge={COOKIE:"cookie",LOCAL_STORAGE:"local-storage"},on=/^([a-zA-Z]+)=([a-z0-9-]+)$/,ht="&";function Tr(e){return!!e&&(e.indexOf(ht)!==-1||on.test(e))}const vr="1";function G(e,t){const n={isExpired:vr};return t.trackAnonymousUser&&(e!=null&&e.anonymousId?n.anonymousId=e==null?void 0:e.anonymousId:n.anonymousId=B()),n}function we(e){return Be(e)}function sn(e){return!we(e)}function de(e){return e.isExpired!==void 0||!Or(e)}function Or(e){return(e.created===void 0||fe()-Number(e.created)<bt)&&(e.expire===void 0||fe()<Number(e.expire))}function cn(e){e.expire=String(fe()+nn)}function un(e){return _r(e).map(([t,n])=>t==="anonymousId"?`aid=${n}`:`${t}=${n}`).join(ht)}function an(e){const t={};return Tr(e)&&e.split(ht).forEach(n=>{const r=on.exec(n);if(r!==null){const[,o,s]=r;o==="aid"?t.anonymousId=s:t[o]=s}}),t}const wr="_dd",xr="_dd_r",Rr="_dd_l",Ir="rum",Ar="logs";function kr(e){if(!H(he)){const n=H(wr),r=H(xr),o=H(Rr),s={};n&&(s.id=n),o&&/^[01]$/.test(o)&&(s[Ar]=o),r&&/^[012]$/.test(r)&&(s[Ir]=r),sn(s)&&(cn(s),e.persistSession(s))}}function xt(e){const t=Nr(e);return Er(t)?{type:ge.COOKIE,cookieOptions:t}:void 0}function Lr(e,t){const n={isLockEnabled:hr(),persistSession:r=>Rt(t,e,r,nn),retrieveSession:ln,expireSession:r=>Rt(t,e,G(r,e),bt)};return kr(n),n}function Rt(e,t,n,r){Fe(he,un(n),t.trackAnonymousUser?Cr:r,e)}function ln(){const e=mt(he);return an(e)}function Nr(e){const t={};return t.secure=!!e.useSecureSessionCookie||!!e.usePartitionedCrossSiteSessionCookie,t.crossSite=!!e.usePartitionedCrossSiteSessionCookie,t.partitioned=!!e.usePartitionedCrossSiteSessionCookie,e.trackSessionAcrossSubdomains&&(t.domain=tn()),t}const Pr="_dd_test_";function It(){try{const e=B(),t=`${Pr}${e}`;localStorage.setItem(t,e);const n=localStorage.getItem(t);return localStorage.removeItem(t),e===n?{type:ge.LOCAL_STORAGE}:void 0}catch{return}}function Ur(e){return{isLockEnabled:!1,persistSession:dn,retrieveSession:$r,expireSession:t=>Mr(t,e)}}function dn(e){localStorage.setItem(he,un(e))}function $r(){const e=localStorage.getItem(he);return an(e)}function Mr(e,t){dn(G(e,t))}function se(e,t,n){if(typeof e!="object"||e===null)return JSON.stringify(e);const r=J(Object.prototype),o=J(Array.prototype),s=J(Object.getPrototypeOf(e)),i=J(e);try{return JSON.stringify(e,t,n)}catch{return"<error: unable to serialize object>"}finally{r(),o(),s(),i()}}function J(e){const t=e,n=t.toJSON;return n?(delete t.toJSON,()=>{t.toJSON=n}):D}const Dr=220*Z,Br="$",Fr=3;function P(e,t=Dr){const n=J(Object.prototype),r=J(Array.prototype),o=[],s=new WeakMap,i=qe(e,Br,void 0,o,s),c=JSON.stringify(i);let u=c?c.length:0;if(u>t){Ye(t,"discarded",e);return}for(;o.length>0&&u<t;){const a=o.shift();let l=0;if(Array.isArray(a.source))for(let d=0;d<a.source.length;d++){const f=qe(a.source[d],a.path,d,o,s);if(f!==void 0?u+=JSON.stringify(f).length:u+=4,u+=l,l=1,u>t){Ye(t,"truncated",e);break}a.target[d]=f}else for(const d in a.source)if(Object.prototype.hasOwnProperty.call(a.source,d)){const f=qe(a.source[d],a.path,d,o,s);if(f!==void 0&&(u+=JSON.stringify(f).length+l+d.length+Fr,l=1),u>t){Ye(t,"truncated",e);break}a.target[d]=f}}return n(),r(),i}function qe(e,t,n,r,o){const s=Hr(e);if(!s||typeof s!="object")return Gr(s);const i=it(s);if(i!=="[Object]"&&i!=="[Array]"&&i!=="[Error]")return i;const c=e;if(o.has(c))return`[Reference seen at ${o.get(c)}]`;const u=n!==void 0?`${t}.${n}`:t,a=Array.isArray(s)?[]:{};return o.set(c,u),r.push({source:s,target:a,path:u}),a}function Gr(e){return typeof e=="bigint"?`[BigInt] ${e.toString()}`:typeof e=="function"?`[Function] ${e.name||"unknown"}`:typeof e=="symbol"?`[Symbol] ${e.description||e.toString()}`:e}function it(e){try{if(e instanceof Event)return jr(e);if(e instanceof RegExp)return`[RegExp] ${e.toString()}`;const n=Object.prototype.toString.call(e).match(/\[object (.*)\]/);if(n&&n[1])return`[${n[1]}]`}catch{}return"[Unserializable]"}function jr(e){return{type:e.type,isTrusted:e.isTrusted,currentTarget:e.currentTarget?it(e.currentTarget):null,target:e.target?it(e.target):null}}function Hr(e){const t=e;if(t&&typeof t.toJSON=="function")try{return t.toJSON()}catch{}return e}function Ye(e,t,n){y.warn(`The data provided has been ${t} as it is over the limit of ${e} characters:`,n)}const te="?";function ie(e){var t,n;const r=[];let o=Ve(e,"stack");const s=String(e);if(o&&o.startsWith(s)&&(o=o.slice(s.length)),o&&o.split(`
`).forEach(i=>{const c=Wr(i)||Yr(i)||Xr(i)||Zr(i);c&&(!c.func&&c.line&&(c.func=te),r.push(c))}),r.length>0&&ro()&&e instanceof Error){const i=[];let c=e;for(;(c=Object.getPrototypeOf(c))&&pn(c);){const u=((t=c.constructor)===null||t===void 0?void 0:t.name)||te;i.push(u)}for(let u=i.length-1;u>=0&&((n=r[0])===null||n===void 0?void 0:n.func)===i[u];u--)r.shift()}return{message:Ve(e,"message"),name:Ve(e,"name"),stack:r}}const fn="((?:file|https?|blob|chrome-extension|electron|native|eval|webpack|snippet|<anonymous>|\\w+\\.|\\/).*?)",ne="(?::(\\d+))",Kr=new RegExp(`^\\s*at (.*?) ?\\(${fn}${ne}?${ne}?\\)?\\s*$`,"i"),zr=new RegExp(`\\((\\S*)${ne}${ne}\\)`);function Wr(e){const t=Kr.exec(e);if(!t)return;const n=t[2]&&t[2].indexOf("native")===0,r=t[2]&&t[2].indexOf("eval")===0,o=zr.exec(t[2]);return r&&o&&(t[2]=o[1],t[3]=o[2],t[4]=o[3]),{args:n?[t[2]]:[],column:t[4]?+t[4]:void 0,func:t[1]||te,line:t[3]?+t[3]:void 0,url:n?void 0:t[2]}}const qr=new RegExp(`^\\s*at ?${fn}${ne}?${ne}??\\s*$`,"i");function Yr(e){const t=qr.exec(e);if(t)return{args:[],column:t[3]?+t[3]:void 0,func:te,line:t[2]?+t[2]:void 0,url:t[1]}}const Vr=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;function Xr(e){const t=Vr.exec(e);if(t)return{args:[],column:t[4]?+t[4]:void 0,func:t[1]||te,line:+t[3],url:t[2]}}const Jr=/^\s*(.*?)(?:\((.*?)\))?(?:(?:(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\[native).*?|[^@]*bundle|\[wasm code\])(?::(\d+))?(?::(\d+))?)|@)\s*$/i,Qr=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;function Zr(e){const t=Jr.exec(e);if(!t)return;const n=t[3]&&t[3].indexOf(" > eval")>-1,r=Qr.exec(t[3]);return n&&r&&(t[3]=r[1],t[4]=r[2],t[5]=void 0),{args:t[2]?t[2].split(","):[],column:t[5]?+t[5]:void 0,func:t[1]||te,line:t[4]?+t[4]:void 0,url:t[3]}}function Ve(e,t){if(typeof e!="object"||!e||!(t in e))return;const n=e[t];return typeof n=="string"?n:void 0}function eo(e,t,n,r){if(t===void 0)return;const{name:o,message:s}=no(e);return{name:o,message:s,stack:[{url:t,column:r,line:n}]}}const to=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\s\S]*)$/;function no(e){let t,n;return{}.toString.call(e)==="[object String]"&&([,t,n]=to.exec(e)),{name:t,message:n}}function pn(e){return String(e.constructor).startsWith("class ")}let _e;function ro(){if(_e!==void 0)return _e;class e extends Error{constructor(){super(),this.name="Error"}}const[t,n]=[e,Error].map(r=>new r);return _e=pn(Object.getPrototypeOf(t))&&n.stack!==t.stack,_e}function Ge(e){const n=new Error(e);n.name="HandlingStack";let r;return pe(()=>{const o=ie(n);o.stack=o.stack.slice(2),r=ce(o)}),r}function ce(e){let t=gn(e);return e.stack.forEach(n=>{const r=n.func==="?"?"<anonymous>":n.func,o=n.args&&n.args.length>0?`(${n.args.join(", ")})`:"",s=n.line?`:${n.line}`:"",i=n.line&&n.column?`:${n.column}`:"";t+=`
  at ${r}${o} @ ${n.url}${s}${i}`}),t}function gn(e){return`${e.name||"Error"}: ${e.message}`}const mn="No stack, consider using an instance of Error";function yt({stackTrace:e,originalError:t,handlingStack:n,componentStack:r,startClocks:o,nonErrorPrefix:s,useFallbackStack:i=!0,source:c,handling:u}){const a=Y(t);return!e&&a&&(e=ie(t)),{startClocks:o,source:c,handling:u,handlingStack:n,componentStack:r,originalError:t,type:e?e.name:void 0,message:oo(e,a,s,t),stack:e?ce(e):i?mn:void 0,causes:a?uo(t,c):void 0,fingerprint:so(t),context:io(t)}}function oo(e,t,n,r){return e!=null&&e.message&&(e!=null&&e.name)?e.message:t?"Empty message":`${n} ${se(P(r))}`}function so(e){return Y(e)&&"dd_fingerprint"in e?String(e.dd_fingerprint):void 0}function io(e){if(e!==null&&typeof e=="object"&&"dd_context"in e)return e.dd_context}function co(e){var t;return(t=/@ (.+)/.exec(e))===null||t===void 0?void 0:t[1]}function Y(e){return e instanceof Error||Object.prototype.toString.call(e)==="[object Error]"}function uo(e,t){let n=e;const r=[];for(;Y(n==null?void 0:n.cause)&&r.length<10;){const o=ie(n.cause);r.push({message:n.cause.message,source:t,type:o==null?void 0:o.name,stack:o&&ce(o)}),n=n.cause}return r.length?r:void 0}const ao="datad0g.com",lo="dd0g-gov.com",Q="datadoghq.com",fo="ddog-gov.com",po="pci.browser-intake-datadoghq.com",go=["ddsource","dd-api-key","dd-request-id"];function bn(e,t){const n=window.__ddBrowserSdkExtensionCallback;n&&n({type:e,payload:t})}function hn(e){return e===null?"null":Array.isArray(e)?"array":typeof e}function Ue(e,t,n=mo()){if(t===void 0)return e;if(typeof t!="object"||t===null)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=t.flags||[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.sticky?"y":"",t.unicode?"u":""].join("");return new RegExp(t.source,o)}if(n.hasAlreadyBeenSeen(t))return;if(Array.isArray(t)){const o=Array.isArray(e)?e:[];for(let s=0;s<t.length;++s)o[s]=Ue(o[s],t[s],n);return o}const r=hn(e)==="object"?e:{};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=Ue(r[o],t[o],n));return r}function yn(e){return Ue(void 0,e)}function z(...e){let t;for(const n of e)n!=null&&(t=Ue(t,n));return t}function mo(){if(typeof WeakSet<"u"){const t=new WeakSet;return{hasAlreadyBeenSeen(n){const r=t.has(n);return r||t.add(n),r}}}const e=[];return{hasAlreadyBeenSeen(t){const n=e.indexOf(t)>=0;return n||e.push(t),n}}}function bo(){var e;const t=window.navigator;return{status:t.onLine?"connected":"not_connected",interfaces:t.connection&&t.connection.type?[t.connection.type]:void 0,effective_type:(e=t.connection)===null||e===void 0?void 0:e.effectiveType}}function Sn(e){return e>=500}function ho(e){try{return e.clone()}catch{return}}const x={AGENT:"agent",CONSOLE:"console",CUSTOM:"custom",LOGGER:"logger",NETWORK:"network",SOURCE:"source",REPORT:"report"},yo=80*Z,So=32,En=3*zt,Eo=q,_n=oe;function Cn(e,t,n,r,o,s){t.transportStatus===0&&t.queuedPayloads.size()===0&&t.bandwidthMonitor.canHandle(e)?vn(e,t,n,s,{onSuccess:()=>On(0,t,n,r,o,s),onFailure:()=>{t.queuedPayloads.enqueue(e)||s.notify({type:"queue-full",bandwidth:t.bandwidthMonitor.stats(),payload:e}),Tn(t,n,r,o,s)}}):t.queuedPayloads.enqueue(e)||s.notify({type:"queue-full",bandwidth:t.bandwidthMonitor.stats(),payload:e})}function Tn(e,t,n,r,o){e.transportStatus===2&&be(()=>{const s=e.queuedPayloads.first();vn(s,e,t,o,{onSuccess:()=>{e.queuedPayloads.dequeue(),e.currentBackoffTime=_n,On(1,e,t,n,r,o)},onFailure:()=>{e.currentBackoffTime=Math.min(Eo,e.currentBackoffTime*2),Tn(e,t,n,r,o)}})},e.currentBackoffTime)}function vn(e,t,n,r,{onSuccess:o,onFailure:s}){t.bandwidthMonitor.add(e),n(e,i=>{t.bandwidthMonitor.remove(e),_o(i)?(t.transportStatus=t.bandwidthMonitor.ongoingRequestCount>0?1:2,e.retry={count:e.retry?e.retry.count+1:1,lastFailureStatus:i.status},r.notify({type:"failure",bandwidth:t.bandwidthMonitor.stats(),payload:e}),s()):(t.transportStatus=0,r.notify({type:"success",bandwidth:t.bandwidthMonitor.stats(),payload:e}),o())})}function On(e,t,n,r,o,s){e===0&&t.queuedPayloads.isFull()&&!t.queueFullReported&&(o({message:`Reached max ${r} events size queued for upload: ${En/zt}MiB`,source:x.AGENT,startClocks:k()}),t.queueFullReported=!0);const i=t.queuedPayloads;for(t.queuedPayloads=wn();i.size()>0;)Cn(i.dequeue(),t,n,r,o,s)}function _o(e){return e.type!=="opaque"&&(e.status===0&&!navigator.onLine||e.status===408||e.status===429||Sn(e.status))}function Co(){return{transportStatus:0,currentBackoffTime:_n,bandwidthMonitor:To(),queuedPayloads:wn(),queueFullReported:!1}}function wn(){const e=[];return{bytesCount:0,enqueue(t){return this.isFull()?!1:(e.push(t),this.bytesCount+=t.bytesCount,!0)},first(){return e[0]},dequeue(){const t=e.shift();return t&&(this.bytesCount-=t.bytesCount),t},size(){return e.length},isFull(){return this.bytesCount>=En}}}function To(){return{ongoingRequestCount:0,ongoingByteCount:0,canHandle(e){return this.ongoingRequestCount===0||this.ongoingByteCount+e.bytesCount<=yo&&this.ongoingRequestCount<So},add(e){this.ongoingRequestCount+=1,this.ongoingByteCount+=e.bytesCount},remove(e){this.ongoingRequestCount-=1,this.ongoingByteCount-=e.bytesCount},stats(){return{ongoingByteCount:this.ongoingByteCount,ongoingRequestCount:this.ongoingRequestCount}}}}function vo(e,t,n){const r=new E,o=Co(),s=(i,c)=>xo(e,t,i,c);return{observable:r,send:i=>{Cn(i,o,s,e.trackType,n,r)},sendOnExit:i=>{Oo(e,t,i)}}}function Oo(e,t,n){if(!!navigator.sendBeacon&&n.bytesCount<t)try{const o=e.build("beacon",n);if(navigator.sendBeacon(o,n.data))return}catch(o){wo(o)}ct(e,n)}let At=!1;function wo(e){At||(At=!0,Vt(e))}function xo(e,t,n,r){if(Ro()&&n.bytesCount<t){const s=e.build("fetch-keepalive",n);fetch(s,{method:"POST",body:n.data,keepalive:!0,mode:"cors"}).then(h(i=>r==null?void 0:r({status:i.status,type:i.type}))).catch(h(()=>ct(e,n,r)))}else ct(e,n,r)}function ct(e,t,n){const r=e.build("fetch",t);fetch(r,{method:"POST",body:t.data,mode:"cors"}).then(h(o=>n==null?void 0:n({status:o.status,type:o.type}))).catch(h(()=>n==null?void 0:n({status:0})))}function Ro(){try{return window.Request&&"keepalive"in new Request("http://a")}catch{return!1}}function St(){const e=Io();if(e)return{getCapabilities(){var t;return JSON.parse(((t=e.getCapabilities)===null||t===void 0?void 0:t.call(e))||"[]")},getPrivacyLevel(){var t;return(t=e.getPrivacyLevel)===null||t===void 0?void 0:t.call(e)},getAllowedWebViewHosts(){return JSON.parse(e.getAllowedWebViewHosts())},send(t,n,r){const o=r?{id:r}:void 0;e.send(JSON.stringify({eventType:t,event:n,view:o}))}}}function $e(e){var t;e===void 0&&(e=(t=L().location)===null||t===void 0?void 0:t.hostname);const n=St();return!!n&&n.getAllowedWebViewHosts().some(r=>e===r||e.endsWith(`.${r}`))}function Io(){return L().DatadogEventBridge}function ue(e,t,n,r,o){return Et(e,t,[n],r,o)}function Et(e,t,n,r,{once:o,capture:s,passive:i}={}){const c=h(f=>{!f.isTrusted&&!f.__ddIsTrusted&&!e.allowUntrustedEvents||(o&&d(),r(f))}),u=i?{capture:s,passive:i}:s,a=window.EventTarget&&t instanceof EventTarget?window.EventTarget.prototype:t,l=ee(a,"addEventListener");n.forEach(f=>l.call(t,f,c,u));function d(){const f=ee(a,"removeEventListener");n.forEach(g=>f.call(t,g,c,u))}return{stop:d}}const xe={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"};function Ao(e){return new E(t=>{const{stop:n}=Et(e,window,["visibilitychange","freeze"],o=>{o.type==="visibilitychange"&&document.visibilityState==="hidden"?t.notify({reason:xe.HIDDEN}):o.type==="freeze"&&t.notify({reason:xe.FROZEN})},{capture:!0}),r=ue(e,window,"beforeunload",()=>{t.notify({reason:xe.UNLOADING})}).stop;return()=>{n(),r()}})}function ko(e){return Pe(xe).includes(e)}function Lo({encoder:e,request:t,flushController:n,messageBytesLimit:r}){let o={};const s=n.flushObservable.subscribe(d=>l(d));function i(d,f,g){n.notifyBeforeAddMessage(f),g!==void 0?(o[g]=d,n.notifyAfterAddMessage()):e.write(e.isEmpty?d:`
${d}`,b=>{n.notifyAfterAddMessage(b-f)})}function c(d){return d!==void 0&&o[d]!==void 0}function u(d){const f=o[d];delete o[d];const g=e.estimateEncodedBytesCount(f);n.notifyAfterRemoveMessage(g)}function a(d,f){const g=se(d),b=e.estimateEncodedBytesCount(g);if(b>=r){y.warn(`Discarded a message whose size was bigger than the maximum allowed size ${r}KB. ${ft} ${Xn}/#technical-limitations`);return}c(f)&&u(f),i(g,b,f)}function l(d){const f=Pe(o).join(`
`);o={};const g=ko(d.reason),b=g?t.sendOnExit:t.send;if(g&&e.isAsync){const S=e.finishSync();S.outputBytesCount&&b(kt(S));const O=[S.pendingData,f].filter(Boolean).join(`
`);O&&b({data:O,bytesCount:Wt(O)})}else f&&e.write(e.isEmpty?f:`
${f}`),e.finish(S=>{b(kt(S))})}return{flushController:n,add:a,upsert:a,stop:s.unsubscribe}}function kt(e){let t;return typeof e.output=="string"?t=e.output:t=new Blob([e.output],{type:"text/plain"}),{data:t,bytesCount:e.outputBytesCount,encoding:e.encoding}}function No({messagesLimit:e,bytesLimit:t,durationLimit:n,pageMayExitObservable:r,sessionExpireObservable:o}){const s=r.subscribe(b=>l(b.reason)),i=o.subscribe(()=>l("session_expire")),c=new E(()=>()=>{s.unsubscribe(),i.unsubscribe()});let u=0,a=0;function l(b){if(a===0)return;const S=a,O=u;a=0,u=0,g(),c.notify({reason:b,messagesCount:S,bytesCount:O})}let d;function f(){d===void 0&&(d=be(()=>{l("duration_limit")},n))}function g(){Xt(d),d=void 0}return{flushObservable:c,get messagesCount(){return a},notifyBeforeAddMessage(b){u+b>=t&&l("bytes_limit"),a+=1,u+=b,f()},notifyAfterAddMessage(b=0){u+=b,a>=e?l("messages_limit"):u>=t&&l("bytes_limit")},notifyAfterRemoveMessage(b){u-=b,a-=1,a===0&&g()}}}function xn(e,t,n,r,o,s,i=Lo){const c=a(e,t),u=n&&a(e,n);function a(l,{endpoint:d,encoder:f}){return i({encoder:f,request:vo(d,l.batchBytesLimit,r),flushController:No({messagesLimit:l.batchMessagesLimit,bytesLimit:l.batchBytesLimit,durationLimit:l.flushTimeout,pageMayExitObservable:o,sessionExpireObservable:s}),messageBytesLimit:l.messageBytesLimit})}return{flushObservable:c.flushController.flushObservable,add(l,d=!0){c.add(l),u&&d&&u.add(n.transformMessage?n.transformMessage(l):l)},upsert:(l,d)=>{c.upsert(l,d),u&&u.upsert(n.transformMessage?n.transformMessage(l):l,d)},stop:()=>{c.stop(),u&&u.stop()}}}const re="DISCARDED",W="SKIPPED";function Po(){const e={};return{register(t,n){return e[t]||(e[t]=[]),e[t].push(n),{unregister:()=>{e[t]=e[t].filter(r=>r!==n)}}},triggerHook(t,n){const r=e[t]||[],o=[];for(const s of r){const i=s(n);if(i===re)return re;i!==W&&o.push(i)}return z(...o)}}}const N={LOG:"log",CONFIGURATION:"configuration",USAGE:"usage"},Uo=["https://www.datadoghq-browser-agent.com","https://www.datad0g-browser-agent.com","https://d3uc069fcn7uxw.cloudfront.net","https://d20xtzwzcl0ceb.cloudfront.net","http://localhost","<anonymous>"],$o=[fo];let Xe;function ye(){return Xe||(Xe=new Zt(100)),Xe}function Mo(e,t,n,r,o,s){const i=new E,{stop:c}=Bo(t,r,o,s,i),{enabled:u}=Do(e,t,n,i);return{stop:c,enabled:u}}function Do(e,t,n,r){const o={},s=!$o.includes(t.site)&&Oe(t.telemetrySampleRate),i={[N.LOG]:s,[N.CONFIGURATION]:s&&Oe(t.telemetryConfigurationSampleRate),[N.USAGE]:s&&Oe(t.telemetryUsageSampleRate)},c=Fo(),u=ye();return u.subscribe(({rawEvent:l,kind:d})=>{if(!i[l.type])return;let f=o[d];if(f||(f=o[d]=new Set),f.size>=t.maxTelemetryEventsPerPage)return;const g=se(l);if(f.has(g))return;const b=n.triggerHook(1,{startTime:k().relative});if(b===re)return;const S=a(b,e,l,c);r.notify(S),bn("telemetry",S),f.add(g)}),u.unbuffer(),ir(jo),{enabled:s};function a(l,d,f,g){const S={type:"telemetry",date:k().timeStamp,service:d,version:"6.17.0",source:"browser",_dd:{format_version:2},telemetry:z(f,{runtime_env:g,connectivity:bo(),sdk_setup:"npm"}),experimental_features:Array.from(br())};return z(S,l)}}function Bo(e,t,n,r,o){const s=[];if($e()){const i=St(),c=o.subscribe(u=>i.send("internal_telemetry",u));s.push(()=>c.unsubscribe())}else{const i=xn(e,{endpoint:e.rumEndpointBuilder,encoder:r(4)},e.replica&&{endpoint:e.replica.rumEndpointBuilder,encoder:r(5)},t,n,new E);s.push(()=>i.stop());const c=o.subscribe(u=>{i.add(u,Go(e))});s.push(()=>c.unsubscribe())}return{stop:()=>s.forEach(i=>i())}}function Fo(){return{is_local_file:window.location.protocol==="file:",is_worker:"WorkerGlobalScope"in self}}function Go(e){return e.site===ao}function Se(e,t){st(_.debug,e,t),ye().notify({rawEvent:{type:N.LOG,message:e,status:"debug",...t},kind:"debug"})}function jo(e,t){ye().notify({rawEvent:{type:N.LOG,status:"error",...zo(e),...t},kind:"error"})}function Ho(e){ye().notify({rawEvent:{type:N.CONFIGURATION,configuration:e},kind:N.CONFIGURATION})}function Ko(e){ye().notify({rawEvent:{type:N.USAGE,usage:e},kind:N.USAGE})}function zo(e){if(Y(e)){const t=ie(e);return{error:{kind:t.name,stack:ce(Wo(t))},message:t.message}}return{error:{stack:mn},message:`Uncaught ${se(e)}`}}function Wo(e){return e.stack=e.stack.filter(t=>!t.url||Uo.some(n=>t.url.startsWith(n))),e}const qo=10,Yo=100,Vo=oe,Rn="--",In=[];let Re;function M(e,t,n=0){var r;const{isLockEnabled:o,persistSession:s,expireSession:i}=t,c=f=>s({...f,lock:a}),u=()=>{const{lock:f,...g}=t.retrieveSession();return{session:g,lock:f&&!Jo(f)?f:void 0}};if(Re||(Re=e),e!==Re){In.push(e);return}if(o&&n>=Yo){Se("Aborted session operation after max lock retries",{currentStore:u()}),Lt(t);return}let a,l=u();if(o){if(l.lock){Ce(e,t,n);return}if(a=Xo(),c(l.session),l=u(),l.lock!==a){Ce(e,t,n);return}}let d=e.process(l.session);if(o&&(l=u(),l.lock!==a)){Ce(e,t,n);return}if(d&&(de(d)?i(d):(cn(d),o?c(d):s(d))),o&&!(d&&de(d))){if(l=u(),l.lock!==a){Ce(e,t,n);return}s(l.session),d=l.session}(r=e.after)===null||r===void 0||r.call(e,d||l.session),Lt(t)}function Ce(e,t,n){be(()=>{M(e,t,n+1)},qo)}function Lt(e){Re=void 0;const t=In.shift();t&&M(t,e)}function Xo(){return B()+Rn+U()}function Jo(e){const[,t]=e.split(Rn);return!t||Ht(Number(t),U())>Vo}const Nt=oe;function Qo(e){switch(e.sessionPersistence){case ge.COOKIE:return xt(e);case ge.LOCAL_STORAGE:return It();case void 0:{let t=xt(e);return!t&&e.allowFallbackToLocalStorage&&(t=It()),t}default:y.error(`Invalid session persistence '${String(e.sessionPersistence)}'`)}}function Zo(e,t){return e.type===ge.COOKIE?Lr(t,e.cookieOptions):Ur(t)}function es(e,t,n,r,o=Zo(e,t)){const s=new E,i=new E,c=new E,u=pt(g,Nt);let a;S();const{throttled:l,cancel:d}=ar(()=>{M({process:m=>{if(we(m))return;const w=b(m);return O(w),w},after:m=>{sn(m)&&!I()&&Kn(m),a=m}},o)},Nt);function f(){M({process:m=>I()?b(m):void 0},o)}function g(){const m={process:w=>de(w)?G(w,t):void 0,after:b};if(mr(Ne.WATCH_COOKIE_WITHOUT_LOCK)){const w=o.retrieveSession();de(w)?M(m,o):b(w)}else M(m,o)}function b(m){return de(m)&&(m=G(m,t)),I()&&(V(m)?Hn():(c.notify({previousState:a,newState:m}),a=m)),m}function S(){M({process:m=>{if(we(m))return G(m,t)},after:m=>{a=m}},o)}function O(m){if(we(m))return!1;const w=r(m[n]);m[n]=w,delete m.isExpired,w!==rn&&!m.id&&(m.id=B(),m.created=String(fe()))}function I(){return(a==null?void 0:a[n])!==void 0}function V(m){return a.id!==m.id||a[n]!==m[n]}function Hn(){a=G(a,t),i.notify()}function Kn(m){a=m,s.notify()}function zn(m){M({process:w=>({...w,...m}),after:b},o)}return{expandOrRenewSession:l,expandSession:f,getSession:()=>a,renewObservable:s,expireObservable:i,sessionStateUpdateObservable:c,restartSession:S,expire:()=>{d(),o.expireSession(a),b(G(a,t))},stop:()=>{Jt(u)},updateSessionState:zn}}const ut={GRANTED:"granted",NOT_GRANTED:"not-granted"};function ts(e){const t=new E;return{tryToInit(n){e||(e=n)},update(n){e=n,t.notify()},isGranted(){return e===ut.GRANTED},observable:t}}function ns(e,t,n=!1){return e.some(r=>{try{if(typeof r=="function")return r(t);if(r instanceof RegExp)return r.test(t);if(typeof r=="string")return n?t.startsWith(r):r===t}catch(o){y.error(o)}return!1})}const rs=["chrome-extension://","moz-extension://"];function Pt(e){return rs.some(t=>e.includes(t))}function os(e,t=new Error().stack){return!Pt(e)&&Pt(t||"")}const Ut="Running the Browser SDK in a Web extension content script is discouraged and will be forbidden in a future major release unless the `allowedTrackingOrigins` option is provided.",ss="SDK initialized on a non-allowed domain.";function is(e,t=typeof location<"u"?location.origin:"",n){const r=e.allowedTrackingOrigins;if(!r)return os(t,n)&&(y.warn(Ut),Se(Ut)),!0;const o=ns(r,t);return o||y.error(ss),o}function _t(e){return cs(e,location.href).href}function cs(e,t){const{URL:n}=us();try{return t!==void 0?new n(e,t):new n(e)}catch(r){throw new Error(`Failed to construct URL: ${String(r)} ${se({url:e,base:t})}`)}}let Je;function us(){if(!Je){let e,t;try{e=document.createElement("iframe"),e.style.display="none",document.body.appendChild(e),t=e.contentWindow}catch{t=window}Je={URL:t.URL},e==null||e.remove()}return Je}function j(e,t){const n=as(e,t);return{build(r,o){const s=ds(e,t,r,o);return n(s)},trackType:t}}function as(e,t){const n=`/api/v2/${t}`,r=e.proxy;if(typeof r=="string"){const s=_t(r);return i=>`${s}?ddforward=${encodeURIComponent(`${n}?${i}`)}`}if(typeof r=="function")return s=>r({path:n,parameters:s});const o=ls(t,e);return s=>`https://${o}${n}?${s}`}function ls(e,t){const{site:n=Q,internalAnalyticsSubdomain:r}=t;if(e==="logs"&&t.usePciIntake&&n===Q)return po;if(r&&n===Q)return`${r}.${Q}`;if(n===lo)return`http-intake.logs.${n}`;const o=n.split("."),s=o.pop();return`browser-intake-${o.join("-")}.${s}`}function ds({clientToken:e,internalAnalyticsSubdomain:t},n,r,{retry:o,encoding:s}){const i=["ddsource=browser",`dd-api-key=${e}`,`dd-evp-origin-version=${encodeURIComponent("6.17.0")}`,"dd-evp-origin=browser",`dd-request-id=${B()}`];return s&&i.push(`dd-evp-encoding=${s}`),n==="rum"&&(i.push(`batch_time=${U()}`,`_dd.api=${r}`),o&&i.push(`_dd.retry_count=${o.count}`,`_dd.retry_after=${o.lastFailureStatus}`)),t&&i.reverse(),i.join("&")}function fs(e){const t=e.site||Q,n=ps(e);return{replica:gs(e),site:t,...n}}function ps(e){return{logsEndpointBuilder:j(e,"logs"),rumEndpointBuilder:j(e,"rum"),profilingEndpointBuilder:j(e,"profile"),sessionReplayEndpointBuilder:j(e,"replay"),exposuresEndpointBuilder:j(e,"exposures")}}function gs(e){if(!e.replica)return;const t={...e,site:Q,clientToken:e.replica.clientToken},n={logsEndpointBuilder:j(t,"logs"),rumEndpointBuilder:j(t,"rum")};return{applicationId:e.replica.applicationId,...n}}function ms(e){return go.every(t=>e.includes(t))}function Qe(e,t){return e!=null&&typeof e!="string"?(y.error(`${t} must be defined as a string`),!1):!0}function bs(e){return e&&typeof e=="string"&&!/(datadog|ddog|datad0g|dd0g)/.test(e)?(y.error(`Site should be a valid Datadog site. ${ft} ${dt}/getting_started/site/.`),!1):!0}function Te(e,t){return e!==void 0&&!Jn(e)?(y.error(`${t} Sample Rate should be a number between 0 and 100`),!1):!0}function hs(e){var t,n,r,o,s,i,c,u,a,l;if(!e||!e.clientToken){y.error("Client Token is not configured, we will not send any data.");return}if(e.allowedTrackingOrigins!==void 0&&!Array.isArray(e.allowedTrackingOrigins)){y.error("Allowed Tracking Origins must be an array");return}if(!(!bs(e.site)||!Te(e.sessionSampleRate,"Session")||!Te(e.telemetrySampleRate,"Telemetry")||!Te(e.telemetryConfigurationSampleRate,"Telemetry Configuration")||!Te(e.telemetryUsageSampleRate,"Telemetry Usage")||!Qe(e.version,"Version")||!Qe(e.env,"Env")||!Qe(e.service,"Service")||!is(e))){if(e.trackingConsent!==void 0&&!qt(ut,e.trackingConsent)){y.error('Tracking Consent should be either "granted" or "not-granted"');return}return{beforeSend:e.beforeSend&&Gt(e.beforeSend,"beforeSend threw an error:"),sessionStoreStrategyType:Qo(e),sessionSampleRate:(t=e.sessionSampleRate)!==null&&t!==void 0?t:100,telemetrySampleRate:(n=e.telemetrySampleRate)!==null&&n!==void 0?n:20,telemetryConfigurationSampleRate:(r=e.telemetryConfigurationSampleRate)!==null&&r!==void 0?r:5,telemetryUsageSampleRate:(o=e.telemetryUsageSampleRate)!==null&&o!==void 0?o:5,service:(s=e.service)!==null&&s!==void 0?s:void 0,env:(i=e.env)!==null&&i!==void 0?i:void 0,version:(c=e.version)!==null&&c!==void 0?c:void 0,datacenter:(u=e.datacenter)!==null&&u!==void 0?u:void 0,silentMultipleInit:!!e.silentMultipleInit,allowUntrustedEvents:!!e.allowUntrustedEvents,trackingConsent:(a=e.trackingConsent)!==null&&a!==void 0?a:ut.GRANTED,trackAnonymousUser:(l=e.trackAnonymousUser)!==null&&l!==void 0?l:!0,storeContextsAcrossPages:!!e.storeContextsAcrossPages,batchBytesLimit:16*Z,eventRateLimiterThreshold:3e3,maxTelemetryEventsPerPage:15,flushTimeout:30*oe,batchMessagesLimit:50,messageBytesLimit:256*Z,...fs(e)}}}function ys(e){return{session_sample_rate:e.sessionSampleRate,telemetry_sample_rate:e.telemetrySampleRate,telemetry_configuration_sample_rate:e.telemetryConfigurationSampleRate,telemetry_usage_sample_rate:e.telemetryUsageSampleRate,use_before_send:!!e.beforeSend,use_partitioned_cross_site_session_cookie:e.usePartitionedCrossSiteSessionCookie,use_secure_session_cookie:e.useSecureSessionCookie,use_proxy:!!e.proxy,silent_multiple_init:e.silentMultipleInit,track_session_across_subdomains:e.trackSessionAcrossSubdomains,track_anonymous_user:e.trackAnonymousUser,session_persistence:e.sessionPersistence,allow_fallback_to_local_storage:!!e.allowFallbackToLocalStorage,store_contexts_across_pages:!!e.storeContextsAcrossPages,allow_untrusted_events:!!e.allowUntrustedEvents,tracking_consent:e.trackingConsent,use_allowed_tracking_origins:Array.isArray(e.allowedTrackingOrigins)}}const Ss=200;function Es(e){const{env:t,service:n,version:r,datacenter:o}=e,s=[X("sdk_version","6.17.0")];return t&&s.push(X("env",t)),n&&s.push(X("service",n)),r&&s.push(X("version",r)),o&&s.push(X("datacenter",o)),s}function X(e,t){const n=t?`${e}:${t}`:e;return(n.length>Ss||_s(n))&&y.warn(`Tag ${n} doesn't meet tag requirements and will be sanitized. ${ft} ${dt}/getting_started/tagging/#defining-tags`),An(n)}function An(e){return e.replace(/,/g,"_")}function _s(e){return Cs()?new RegExp("[^\\p{Ll}\\p{Lo}0-9_:./-]","u").test(e):!1}function Cs(){try{return new RegExp("[\\p{Ll}]","u"),!0}catch{return!1}}function K(e,t,n,{computeHandlingStack:r}={}){let o=e[t];if(typeof o!="function")if(t in e&&t.startsWith("on"))o=D;else return{stop:D};let s=!1;const i=function(){if(s)return o.apply(this,arguments);const c=Array.from(arguments);let u;pe(n,null,[{target:this,parameters:c,onPostCall:l=>{u=l},handlingStack:r?Ge("instrumented method"):void 0}]);const a=o.apply(this,c);return u&&pe(u,null,[a]),a};return e[t]=i,{stop:()=>{s=!0,e[t]===i&&(e[t]=o)}}}function Ts(){return new E(e=>{const t=(o,s)=>{const i=yt({stackTrace:s,originalError:o,startClocks:k(),nonErrorPrefix:"Uncaught",source:x.SOURCE,handling:"unhandled"});e.notify(i)},{stop:n}=vs(t),{stop:r}=Os(t);return()=>{n(),r()}})}function vs(e){return K(L(),"onerror",({parameters:[t,n,r,o,s]})=>{let i;Y(s)||(i=eo(t,n,r,o)),e(s??t,i)})}function Os(e){return K(L(),"onunhandledrejection",({parameters:[t]})=>{e(t.reason||"Empty reason")})}function ws(e){const t={version:"6.17.0",onReady(n){n()},...e};return Object.defineProperty(t,"_setDebug",{get(){return cr},enumerable:!1}),t}function xs(e,t,n){const r=e[t];r&&!r.q&&r.version&&y.warn("SDK is loaded more than once. This is unsupported and might have unexpected behavior."),e[t]=n,r&&r.q&&r.q.forEach(o=>Gt(o,"onReady callback threw an error:")())}function kn(e,t){t.silentMultipleInit||y.error(`${e} is already initialized.`)}const Me={intervention:"intervention",deprecation:"deprecation",cspViolation:"csp_violation"};function Rs(e,t){const n=[];t.includes(Me.cspViolation)&&n.push(As(e));const r=t.filter(o=>o!==Me.cspViolation);return r.length&&n.push(Is(r)),Qt(...n)}function Is(e){return new E(t=>{if(!window.ReportingObserver)return;const n=h((o,s)=>o.forEach(i=>t.notify(ks(i)))),r=new window.ReportingObserver(n,{types:e,buffered:!0});return r.observe(),()=>{r.disconnect()}})}function As(e){return new E(t=>{const{stop:n}=ue(e,document,"securitypolicyviolation",r=>{t.notify(Ls(r))});return n})}function ks(e){const{type:t,body:n}=e;return Ln({type:n.id,message:`${t}: ${n.message}`,originalError:e,stack:Nn(n.id,n.message,n.sourceFile,n.lineNumber,n.columnNumber)})}function Ls(e){const t=`'${e.blockedURI}' blocked by '${e.effectiveDirective}' directive`;return Ln({type:e.effectiveDirective,message:`${Me.cspViolation}: ${t}`,originalError:e,csp:{disposition:e.disposition},stack:Nn(e.effectiveDirective,e.originalPolicy?`${t} of the policy "${fr(e.originalPolicy,100,"...")}"`:"no policy",e.sourceFile,e.lineNumber,e.columnNumber)})}function Ln(e){return{startClocks:k(),source:x.REPORT,handling:"unhandled",...e}}function Nn(e,t,n,r,o){return n?ce({name:e,message:t,stack:[{func:"?",url:n,line:r??void 0,column:o??void 0}]}):void 0}function Ns(e){const t=new Set;return e.forEach(n=>t.add(n)),Array.from(t)}function Pn(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}const ve=1/0,Ps=q;let le=null;const Ie=new Set;function Us(){Ie.forEach(e=>e())}function $s({expireDelay:e,maxEntries:t}){let n=[];le||(le=pt(()=>Us(),Ps));const r=()=>{const l=Ae()-e;for(;n.length>0&&n[n.length-1].endTime<l;)n.pop()};Ie.add(r);function o(l,d){const f={value:l,startTime:d,endTime:ve,remove:()=>{Pn(n,f)},close:g=>{f.endTime=g}};return t&&n.length>=t&&n.pop(),n.unshift(f),f}function s(l=ve,d={returnInactive:!1}){for(const f of n)if(f.startTime<=l){if(d.returnInactive||l<=f.endTime)return f.value;break}}function i(l){const d=n[0];d&&d.endTime===ve&&d.close(l)}function c(l=ve,d=0){const f=nr(l,d);return n.filter(g=>g.startTime<=f&&l<=g.endTime).map(g=>g.value)}function u(){n=[]}function a(){Ie.delete(r),Ie.size===0&&le&&(Jt(le),le=null)}return{add:o,find:s,closeActive:i,findAll:c,reset:u,stop:a}}const Ms="datadog-synthetics-public-id",Ds="datadog-synthetics-result-id",Bs="datadog-synthetics-injects-rum";function Un(){return!!(window._DATADOG_SYNTHETICS_INJECTS_RUM||H(Bs))}function $n(){const e=window._DATADOG_SYNTHETICS_PUBLIC_ID||H(Ms);return typeof e=="string"?e:void 0}function Mn(){const e=window._DATADOG_SYNTHETICS_RESULT_ID||H(Ds);return typeof e=="string"?e:void 0}function Fs(){return!!($n()&&Mn())}const Gs=q,js=bt;function Hs(e,t,n,r){const o=new E,s=new E,i=es(e.sessionStoreStrategyType,e,t,n),c=$s({expireDelay:js});i.renewObservable.subscribe(()=>{c.add(u(),Ae()),o.notify()}),i.expireObservable.subscribe(()=>{s.notify(),c.closeActive(Ae())}),i.expandOrRenewSession(),c.add(u(),tr().relative),r.observable.subscribe(()=>{r.isGranted()?i.expandOrRenewSession():i.expire()}),Ks(e,()=>{r.isGranted()&&i.expandOrRenewSession()}),zs(e,()=>i.expandSession()),Ws(e,()=>i.restartSession());function u(){const a=i.getSession();return a?{id:a.id,trackingType:a[t],isReplayForced:!!a.forcedReplay,anonymousId:a.anonymousId}:(qs().catch(()=>{}),{id:"invalid",trackingType:rn,isReplayForced:!1,anonymousId:void 0})}return{findSession:(a,l)=>c.find(a,l),renewObservable:o,expireObservable:s,sessionStateUpdateObservable:i.sessionStateUpdateObservable,expire:i.expire,updateSessionState:i.updateSessionState}}function Ks(e,t){Et(e,window,["click","touchstart","keydown","scroll"],t,{capture:!0,passive:!0})}function zs(e,t){const n=()=>{document.visibilityState==="visible"&&t()};ue(e,document,"visibilitychange",n),pt(n,Gs)}function Ws(e,t){ue(e,window,"resume",t,{capture:!0})}async function qs(){const e=ln();let t=[];"cookieStore"in window?t=await window.cookieStore.getAll("_dd_s"):t=document.cookie.split(/\s*;\s*/).filter(n=>n.startsWith("_dd_s")),Se("Unexpected session state",{session:e,isSyntheticsTest:Fs(),createdTimestamp:e==null?void 0:e.created,expireTimestamp:e==null?void 0:e.expire,cookie:{count:t.length,domain:tn(),...t},currentDomain:`${window.location.protocol}//${window.location.hostname}`})}function at(){let e="",t=0;return{isAsync:!1,get isEmpty(){return!e},write(n,r){const o=Wt(n);t+=o,e+=n,r&&r(o)},finish(n){n(this.finishSync())},finishSync(){const n={output:e,outputBytesCount:t,rawBytesCount:t,pendingData:""};return e="",t=0,n},estimateEncodedBytesCount(n){return n.length}}}class Ys{constructor(){this.callbacks={}}notify(t,n){const r=this.callbacks[t];r&&r.forEach(o=>o(n))}subscribe(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),{unsubscribe:()=>{this.callbacks[t]=this.callbacks[t].filter(r=>n!==r)}}}}function Vs(e,t,n){let r=0,o=!1;return{isLimitReached(){if(r===0&&be(()=>{r=0},q),r+=1,r<=t||o)return o=!1,!1;if(r===t+1){o=!0;try{n({message:`Reached max number of ${e}s by minute: ${t}`,source:x.AGENT,startClocks:k()})}finally{o=!1}}return!0}}}let Ze;const Ct=new WeakMap;function Xs(e){return Ze||(Ze=Js(e)),Ze}function Js(e){return new E(t=>{const{stop:n}=K(XMLHttpRequest.prototype,"open",Qs),{stop:r}=K(XMLHttpRequest.prototype,"send",s=>{Zs(s,e,t)},{computeHandlingStack:!0}),{stop:o}=K(XMLHttpRequest.prototype,"abort",ei);return()=>{n(),r(),o()}})}function Qs({target:e,parameters:[t,n]}){Ct.set(e,{state:"open",method:String(t).toUpperCase(),url:_t(String(n))})}function Zs({target:e,handlingStack:t},n,r){const o=Ct.get(e);if(!o)return;const s=o;s.state="start",s.startClocks=k(),s.isAborted=!1,s.xhr=e,s.handlingStack=t;let i=!1;const{stop:c}=K(e,"onreadystatechange",()=>{e.readyState===XMLHttpRequest.DONE&&u()}),u=()=>{if(a(),c(),i)return;i=!0;const l=o;l.state="complete",l.duration=Ht(s.startClocks.timeStamp,U()),l.status=e.status,r.notify(sr(l))},{stop:a}=ue(n,e,"loadend",u);r.notify(s)}function ei({target:e}){const t=Ct.get(e);t&&(t.isAborted=!0)}let et;function Dn(){return et||(et=ti()),et}function ti(){return new E(e=>{if(!window.fetch)return;const{stop:t}=K(window,"fetch",n=>ni(n,e),{computeHandlingStack:!0});return t})}function ni({parameters:e,onPostCall:t,handlingStack:n},r){const[o,s]=e;let i=s&&s.method;i===void 0&&o instanceof Request&&(i=o.method);const c=i!==void 0?String(i).toUpperCase():"GET",u=o instanceof Request?o.url:_t(String(o)),a=k(),l={state:"start",init:s,input:o,method:c,startClocks:a,url:u,handlingStack:n};r.notify(l),e[0]=l.input,e[1]=l.init,t(d=>ri(r,d,l))}function ri(e,t,n){const r=n;function o(s){r.state="resolve",Object.assign(r,s),e.notify(r)}t.then(h(s=>{o({response:s,responseType:s.type,status:s.status,isAborted:!1})}),h(s=>{var i,c;o({status:0,isAborted:((c=(i=r.init)===null||i===void 0?void 0:i.signal)===null||c===void 0?void 0:c.aborted)||s instanceof DOMException&&s.code===DOMException.ABORT_ERR,error:s})}))}let tt={};function oi(e){const t=e.map(n=>(tt[n]||(tt[n]=si(n)),tt[n]));return Qt(...t)}function si(e){return new E(t=>{const n=A[e];return A[e]=(...r)=>{n.apply(console,r);const o=Ge("console error");pe(()=>{t.notify(ii(r,e,o))})},()=>{A[e]=n}})}function ii(e,t,n){const r=e.map(o=>ci(o)).join(" ");if(t===_.error){const o=e.find(Y),s=yt({originalError:o,handlingStack:n,startClocks:k(),source:x.CONSOLE,handling:"handled",nonErrorPrefix:"Provided",useFallbackStack:!1});return s.message=r,{api:t,message:r,handlingStack:n,error:s}}return{api:t,message:r,error:void 0,handlingStack:n}}function ci(e){return typeof e=="string"?P(e):Y(e)?gn(ie(e)):se(P(e),void 0,2)}const ui=500;function ai(){const e=[];return{add:o=>{e.push(o)>ui&&e.splice(0,1)},remove:o=>{Pn(e,o)},drain:o=>{e.forEach(s=>s(o)),e.length=0}}}function li(e){const t=hn(e)==="object";return t||y.error("Unsupported context:",e),t}function nt(e,t,n){const r={...e};for(const[o,{required:s,type:i}]of Object.entries(t))i==="string"&&!$t(r[o])&&(r[o]=String(r[o])),s&&$t(r[o])&&y.warn(`The property ${o} of ${n} is required; context will not be sent to the intake.`);return r}function $t(e){return e==null||e===""}function je(e="",{propertiesConfig:t={}}={}){let n={};const r=new E,o={getContext:()=>yn(n),setContext:s=>{li(s)?n=P(nt(s,t,e)):o.clearContext(),r.notify()},setContextProperty:(s,i)=>{n=P(nt({...n,[s]:i},t,e)),r.notify()},removeContextProperty:s=>{delete n[s],nt(n,t,e),r.notify()},clearContext:()=>{n={},r.notify()},changeObservable:r};return o}function T(e,t,n,r){return h((...o)=>e()[t][n](...o))}function rt(e,t,n){e.changeObservable.subscribe(()=>{const r=e.getContext();n.add(o=>o[t].setContext(r))})}const di="_dd_c",fi=[];function Tt(e,t,n,r){const o=pi(n,r);fi.push(ue(e,window,"storage",({key:a})=>{o===a&&i()})),t.changeObservable.subscribe(c);const s=z(u(),t.getContext());Be(s)||t.setContext(s);function i(){t.setContext(u())}function c(){localStorage.setItem(o,JSON.stringify(t.getContext()))}function u(){const a=localStorage.getItem(o);return a?JSON.parse(a):{}}}function pi(e,t){return`${di}_${e}_${t}`}function gi(e,t,n){const r=Bn();return t.storeContextsAcrossPages&&Tt(t,r,n,4),e.register(0,()=>{const o=r.getContext();return Be(o)||!o.id?W:{account:o}}),r}function Bn(){return je("account",{propertiesConfig:{id:{type:"string",required:!0},name:{type:"string"}}})}function mi(e,t,n,r){const o=Fn();return t.storeContextsAcrossPages&&Tt(t,o,n,2),e.register(0,()=>o.getContext()),o}function Fn(){return je("global context")}function bi(e,t,n,r){const o=Gn();return t.storeContextsAcrossPages&&Tt(t,o,r,1),e.register(0,({eventType:s,startTime:i})=>{const c=o.getContext(),u=n.findTrackedSession(i);return u&&u.anonymousId&&!c.anonymous_id&&t.trackAnonymousUser&&(c.anonymous_id=u.anonymousId),Be(c)?W:{type:s,usr:c}}),e.register(1,({startTime:s})=>{var i;return{anonymous_id:(i=n.findTrackedSession(s))===null||i===void 0?void 0:i.anonymousId}}),o}function Gn(){return je("user",{propertiesConfig:{id:{type:"string"},name:{type:"string"},email:{type:"string"}}})}const C={userContext:"userContext",globalContext:"globalContext",accountContext:"accountContext"},v={getContext:"getContext",setContext:"setContext",setContextProperty:"setContextProperty",removeContextProperty:"removeContextProperty",clearContext:"clearContext"};function hi(e,t,n){const r=e.getReader(),o=[];let s=0;i();function i(){r.read().then(h(u=>{if(u.done){c();return}o.push(u.value),s+=u.value.length,s>n.bytesLimit?c():i()}),h(u=>t(u)))}function c(){r.cancel().catch(D);let u,a;{let l;if(o.length===1)l=o[0];else{l=new Uint8Array(s);let d=0;o.forEach(f=>{l.set(f,d),d+=f.length})}u=l.slice(0,n.bytesLimit),a=l.length>n.bytesLimit}t(void 0,u,a)}}const Mt={DOCUMENT:"document",XHR:"xhr",BEACON:"beacon",FETCH:"fetch",CSS:"css",JS:"js",IMAGE:"image",FONT:"font",MEDIA:"media",OTHER:"other"},lt={FETCH:Mt.FETCH,XHR:Mt.XHR},yi=500;function Si(e=Ts){const t=new Zt(yi),n=e().subscribe(r=>{t.notify({type:0,error:r})});return{observable:t,stop:()=>{n.unsubscribe()}}}function De(e,t,n){const r=n.getHandler(),o=Array.isArray(r)?r:[r];return Dt[e]>=Dt[n.getLevel()]&&o.includes(t)}const p={ok:"ok",debug:"debug",info:"info",notice:"notice",warn:"warn",error:"error",critical:"critical",alert:"alert",emerg:"emerg"},Dt={[p.ok]:0,[p.debug]:1,[p.info]:2,[p.notice]:4,[p.warn]:5,[p.error]:6,[p.critical]:7,[p.alert]:8,[p.emerg]:9};function He(e,{includeMessage:t=!1}={}){return{stack:e.stack,kind:e.type,message:t?e.message:void 0,causes:e.causes,fingerprint:e.fingerprint,handling:e.handling}}var Ei=function(e,t,n,r){var o=arguments.length,s=o<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};const me={console:"console",http:"http",silent:"silent"},_i=Object.keys(p);class R{constructor(t,n,r=me.http,o=p.debug,s={}){this.handleLogStrategy=t,this.handlerType=r,this.level=o,this.contextManager=je("logger"),this.tags=[],this.contextManager.setContext(s),n&&this.contextManager.setContextProperty("logger",{name:n})}logImplementation(t,n,r=p.info,o,s){const i=P(n);let c;if(o!=null){const u=yt({originalError:o,nonErrorPrefix:"Provided",source:x.LOGGER,handling:"handled",startClocks:k()});c=z({error:He(u,{includeMessage:!0})},u.context,i)}else c=i;this.handleLogStrategy({message:P(t),context:c,status:r},this,s)}log(t,n,r=p.info,o){let s;De(r,me.http,this)&&(s=Ge("log")),this.logImplementation(t,n,r,o,s)}setContext(t){this.contextManager.setContext(t)}getContext(){return this.contextManager.getContext()}setContextProperty(t,n){this.contextManager.setContextProperty(t,n)}removeContextProperty(t){this.contextManager.removeContextProperty(t)}clearContext(){this.contextManager.clearContext()}addTag(t,n){this.tags.push(X(t,n))}removeTagsWithKey(t){const n=An(t);this.tags=this.tags.filter(r=>r!==n&&!r.startsWith(`${n}:`))}getTags(){return this.tags.slice()}setHandler(t){this.handlerType=t}getHandler(){return this.handlerType}setLevel(t){this.level=t}getLevel(){return this.level}}Ei([ur],R.prototype,"logImplementation",null);R.prototype.ok=$(p.ok);R.prototype.debug=$(p.debug);R.prototype.info=$(p.info);R.prototype.notice=$(p.notice);R.prototype.warn=$(p.warn);R.prototype.error=$(p.error);R.prototype.critical=$(p.critical);R.prototype.alert=$(p.alert);R.prototype.emerg=$(p.emerg);function $(e){return function(t,n,r){let o;De(e,me.http,this)&&(o=Ge("log")),this.logImplementation(t,n,e,r,o)}}function Bt(){return{view:{referrer:document.referrer,url:window.location.href}}}const Ci=32*Z;function Ti(e){e.usePciIntake===!0&&e.site&&e.site!=="datadoghq.com"&&y.warn("PCI compliance for Logs is only available for Datadog organizations in the US1 site. Default intake will be used.");const t=hs(e),n=Ft(e.forwardConsoleLogs,Pe(_),"Forward Console Logs"),r=Ft(e.forwardReports,Pe(Me),"Forward Reports");if(!(!t||!n||!r))return e.forwardErrorsToLogs&&!n.includes(_.error)&&n.push(_.error),{forwardErrorsToLogs:e.forwardErrorsToLogs!==!1,forwardConsoleLogs:n,forwardReports:r,requestErrorResponseLengthLimit:Ci,...t}}function Ft(e,t,n){if(e===void 0)return[];if(!(e==="all"||Array.isArray(e)&&e.every(r=>t.includes(r)))){y.error(`${n} should be "all" or an array with allowed values "${t.join('", "')}"`);return}return e==="all"?t:Ns(e)}function vi(e){const t=ys(e);return{forward_errors_to_logs:e.forwardErrorsToLogs,forward_console_logs:e.forwardConsoleLogs,forward_reports:e.forwardReports,use_pci_intake:e.usePciIntake,...t}}function Oi(e,t,n){const r=ai(),o=Fn();rt(o,C.globalContext,r);const s=Bn();rt(s,C.accountContext,r);const i=Gn();rt(i,C.userContext,r);let c,u;const a=t.observable.subscribe(l);function l(){if(!u||!c||!t.isGranted())return;a.unsubscribe();const d=n(c,u);r.drain(d)}return{init(d){if(!d){y.error("Missing configuration");return}if(pr(d.enableExperimentalFeatures),$e()&&(d=wi(d)),c=d,Ho(vi(d)),u){kn("DD_LOGS",d);return}const f=Ti(d);f&&(u=f,Dn().subscribe(D),t.tryToInit(f.trackingConsent),l())},get initConfiguration(){return c},globalContext:o,accountContext:s,userContext:i,getInternalContext:D,handleLog(d,f,g,b=e(),S=U()){r.add(O=>O.handleLog(d,f,g,b,S))}}}function wi(e){return{...e,clientToken:"empty"}}function xi(e){const t=ts(),n=Si().observable;let r=Oi(Bt,t,(c,u)=>{const a=e(u,Bt,t,n);return r=Ri(c,a),a});const o=()=>r,s={},i=new R((...c)=>r.handleLog(...c));return ws({logger:i,init:h(c=>r.init(c)),setTrackingConsent:h(c=>{t.update(c),Ko({feature:"set-tracking-consent",tracking_consent:c})}),getGlobalContext:T(o,C.globalContext,v.getContext),setGlobalContext:T(o,C.globalContext,v.setContext),setGlobalContextProperty:T(o,C.globalContext,v.setContextProperty),removeGlobalContextProperty:T(o,C.globalContext,v.removeContextProperty),clearGlobalContext:T(o,C.globalContext,v.clearContext),createLogger:h((c,u={})=>(s[c]=new R((...a)=>r.handleLog(...a),P(c),u.handler,u.level,P(u.context)),s[c])),getLogger:h(c=>s[c]),getInitConfiguration:h(()=>yn(r.initConfiguration)),getInternalContext:h(c=>r.getInternalContext(c)),setUser:T(o,C.userContext,v.setContext),getUser:T(o,C.userContext,v.getContext),setUserProperty:T(o,C.userContext,v.setContextProperty),removeUserProperty:T(o,C.userContext,v.removeContextProperty),clearUser:T(o,C.userContext,v.clearContext),setAccount:T(o,C.accountContext,v.setContext),getAccount:T(o,C.accountContext,v.getContext),setAccountProperty:T(o,C.accountContext,v.setContextProperty),removeAccountProperty:T(o,C.accountContext,v.removeContextProperty),clearAccount:T(o,C.accountContext,v.clearContext)})}function Ri(e,t){return{init:n=>{kn("DD_LOGS",n)},initConfiguration:e,...t}}const Ii="logs";function Ai(e,t){const n=Hs(e,Ii,r=>jn(e,r),t);return{findTrackedSession:(r,o={returnInactive:!1})=>{const s=n.findSession(r,o);return s&&s.trackingType==="1"?{id:s.id,anonymousId:s.anonymousId}:void 0},expireObservable:n.expireObservable}}function ki(e){const n=jn(e)==="1"?{}:void 0;return{findTrackedSession:()=>n,expireObservable:new E}}function jn(e,t){return Li(t)?t:Oe(e.sessionSampleRate)?"1":"0"}function Li(e){return e==="0"||e==="1"}function Ni(e,t,n,r,o){const s=_i.concat(["custom"]),i={};s.forEach(c=>{i[c]=Vs(c,e.eventRateLimiterThreshold,o)}),t.subscribe(0,({rawLogsEvent:c,messageContext:u=void 0,savedCommonContext:a=void 0,domainContext:l,ddtags:d=[]})=>{var f,g;const b=rr(c.date),S=a||r(),O=n.triggerHook(0,{startTime:b});if(O===re)return;const I=Es(e),V=z({view:S.view},O,c,u,{ddtags:I.concat(d).join(",")});((f=e.beforeSend)===null||f===void 0?void 0:f.call(e,V,l))===!1||V.origin!==x.AGENT&&((g=i[V.status])!==null&&g!==void 0?g:i.custom).isLimitReached()||t.notify(1,V)})}const Pi={[_.log]:p.info,[_.debug]:p.debug,[_.info]:p.info,[_.warn]:p.warn,[_.error]:p.error};function Ui(e,t){const n=oi(e.forwardConsoleLogs).subscribe(r=>{var o;const s={rawLogsEvent:{date:U(),message:r.message,origin:x.CONSOLE,error:r.error&&He(r.error),status:Pi[r.api]},messageContext:(o=r.error)===null||o===void 0?void 0:o.context,domainContext:{handlingStack:r.handlingStack}};t.notify(0,s)});return{stop:()=>{n.unsubscribe()}}}function $i(e,t){const n=Rs(e,e.forwardReports).subscribe(r=>{let o=r.message,s;const i=r.originalError.type==="deprecation"?p.warn:p.error;i===p.error?s=He(r):r.stack&&(o+=` Found in ${co(r.stack)}`),t.notify(0,{rawLogsEvent:{date:U(),message:o,origin:x.REPORT,error:s,status:i}})});return{stop:()=>{n.unsubscribe()}}}function Mi(e,t){if(!e.forwardErrorsToLogs)return{stop:D};const n=Xs(e).subscribe(s=>{s.state==="complete"&&o(lt.XHR,s)}),r=Dn().subscribe(s=>{s.state==="resolve"&&o(lt.FETCH,s)});function o(s,i){!ms(i.url)&&(Gi(i)||Sn(i.status))&&("xhr"in i?Di(i.xhr,e,c):i.response?Fi(i.response,e,c):i.error&&Bi(i.error,e,c));function c(u){const a={isAborted:i.isAborted,handlingStack:i.handlingStack};t.notify(0,{rawLogsEvent:{message:`${ji(s)} error ${i.method} ${i.url}`,date:i.startClocks.timeStamp,error:{stack:u||"Failed to load",handling:void 0},http:{method:i.method,status_code:i.status,url:i.url},status:p.error,origin:x.NETWORK},domainContext:a})}}return{stop:()=>{n.unsubscribe(),r.unsubscribe()}}}function Di(e,t,n){typeof e.response=="string"?n(vt(e.response,t)):n(e.response)}function Bi(e,t,n){n(vt(ce(ie(e)),t))}function Fi(e,t,n){const r=ho(e);!r||!r.body?n():window.TextDecoder?Hi(r.body,t.requestErrorResponseLengthLimit,(o,s)=>{n(o?`Unable to retrieve response: ${o}`:s)}):r.text().then(h(o=>n(vt(o,t))),h(o=>n(`Unable to retrieve response: ${o}`)))}function Gi(e){return e.status===0&&e.responseType!=="opaque"}function vt(e,t){return e.length>t.requestErrorResponseLengthLimit?`${e.substring(0,t.requestErrorResponseLengthLimit)}...`:e}function ji(e){return lt.XHR===e?"XHR":"Fetch"}function Hi(e,t,n){hi(e,(r,o,s)=>{if(r)n(r);else{let i=new TextDecoder().decode(o);s&&(i+="..."),n(void 0,i)}},{bytesLimit:t,collectStreamBody:!0})}function Ki(e,t,n){if(!e.forwardErrorsToLogs)return{stop:D};const r=n.subscribe(o=>{if(o.type===0){const s=o.error;t.notify(0,{rawLogsEvent:{message:s.message,date:s.startClocks.timeStamp,error:He(s),origin:x.SOURCE,status:p.error},messageContext:s.context})}});return{stop:()=>{r.unsubscribe()}}}const zi=Ys;function Wi(e){function t(n,r,o,s,i){const c=z(r.getContext(),n.context);if(De(n.status,me.console,r)&&Yi(n,c),De(n.status,me.http,r)){const u={rawLogsEvent:{date:i||U(),message:n.message,status:n.status,origin:x.LOGGER},messageContext:c,savedCommonContext:s,ddtags:r.getTags()};o&&(u.domainContext={handlingStack:o}),e.notify(0,u)}}return{handleLog:t}}const qi={[p.ok]:_.debug,[p.debug]:_.debug,[p.info]:_.info,[p.notice]:_.info,[p.warn]:_.warn,[p.error]:_.error,[p.critical]:_.error,[p.alert]:_.error,[p.emerg]:_.error};function Yi({status:e,message:t},n){F[qi[e]].call(A,t,n)}function Vi(e,t,n,r,o){const s=xn(e,{endpoint:e.logsEndpointBuilder,encoder:at()},e.replica&&{endpoint:e.replica.logsEndpointBuilder,encoder:at()},n,r,o.expireObservable);return t.subscribe(1,i=>{s.add(i)}),s}function Xi(e){const t=St();e.subscribe(1,n=>{t.send("log",n)})}function Ji(e){return{get:t=>{const n=e.findTrackedSession(t);if(n)return{session_id:n.id}}}}function Qi(e){return t=>{e.notify(0,{rawLogsEvent:{message:t.message,date:t.startClocks.timeStamp,origin:x.AGENT,status:p.error}}),Se("Error reported to customer",{"error.message":t.message})}}const Zi=Po;function ec(e){const t=window;let n=!1;e.register(0,({startTime:s})=>{const i=r(s);return i||W}),e.register(1,({startTime:s})=>{var i,c;const u=r(s);return u?{application:{id:u.application_id},view:{id:(i=u.view)===null||i===void 0?void 0:i.id},action:{id:(c=u.user_action)===null||c===void 0?void 0:c.id}}:W});function r(s){const i=Un(),c=i?t.DD_RUM_SYNTHETICS:t.DD_RUM,u=o(s,c);if(u)return u;i&&!n&&(n=!0,Se("Logs sent before RUM is injected by the synthetics worker",{testId:$n(),resultId:Mn()}))}function o(s,i){if(i&&i.getInternalContext)return i.getInternalContext(s)}return{stop:()=>{n=!1}}}function tc(e,t,n){e.register(0,({startTime:r})=>{const o=n.findTrackedSession(r);return n.findTrackedSession(r,{returnInactive:!0})?{service:t.service,session_id:o?o.id:void 0,session:o?{id:o.id}:void 0}:re}),e.register(1,({startTime:r})=>{const o=n.findTrackedSession(r);return!o||!o.id?W:{session:{id:o.id}}})}function nc(e,t){function n(){return t.isGranted()?W:re}e.register(0,n),e.register(1,n)}const ot="logs";function rc(e,t,n,r){const o=new zi,s=Zi(),i=[];o.subscribe(1,I=>bn("logs",I));const c=Qi(o),u=Ao(e),a=Mo("browser-logs-sdk",e,s,c,u,at);i.push(a.stop);const l=e.sessionStoreStrategyType&&!$e()&&!Un()?Ai(e,n):ki(e);nc(s,n),tc(s,e,l);const d=gi(s,e,ot),f=bi(s,e,l,ot),g=mi(s,e,ot),{stop:b}=ec(s);Mi(e,o),Ki(e,o,r),r.unbuffer(),Ui(e,o),$i(e,o);const{handleLog:S}=Wi(o);if(Ni(e,o,s,t,c),$e())Xi(o);else{const{stop:I}=Vi(e,o,c,u,l);i.push(()=>I())}const O=Ji(l);return{handleLog:S,getInternalContext:O.get,accountContext:d,globalContext:g,userContext:f,stop:()=>{i.forEach(I=>I()),b()}}}const Ot=xi(rc);xs(L(),"DD_LOGS",Ot);const sc=()=>{Ot.init({clientToken:Wn,site:"datadoghq.com",forwardErrorsToLogs:!1,service:"svelte-stake",env:`${qn}-${Yn}-${Vn}`,sessionSampleRate:100})},ic=(e,t={},n)=>{const r=n instanceof Error?n:void 0;Ot.logger.error(e,t,r)};export{sc as i,ic as l};
