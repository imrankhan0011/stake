import{f as M}from"./BV84Ne7d.js";import{e as s}from"./CH8lUi8C.js";import{g as F}from"./C3Uqgz1j.js";import{l as E}from"./BnZzCvUo.js";import{w as D}from"./mJIF3ZvJ.js";import{a as R}from"./CQrL6g3R.js";import{b as V}from"./BS6f7dTc.js";const r=D(!1),d=E("geocomplyVerified",!1),Z=D(0);var u,p,y;const _=(y=(p=(u=window==null?void 0:window.navigator)==null?void 0:u.userAgent)==null?void 0:p.toLowerCase())==null?void 0:y.includes("android");var g,w,k,f,v,G,L,S,b;const $=((k=(w=(g=window==null?void 0:window.navigator)==null?void 0:g.userAgent)==null?void 0:w.toLowerCase())==null?void 0:k.includes("mobile"))&&(((G=(v=(f=window==null?void 0:window.navigator)==null?void 0:f.userAgent)==null?void 0:v.toLowerCase())==null?void 0:G.includes("iphone"))||((b=(S=(L=window==null?void 0:window.navigator)==null?void 0:L.userAgent)==null?void 0:S.toLowerCase())==null?void 0:b.includes("ipad")));var I,h,C;const ee=(C=(h=(I=window==null?void 0:window.navigator)==null?void 0:I.userAgent)==null?void 0:h.toLowerCase())==null?void 0:C.includes("mac");var x,N,A;const te=(A=(N=(x=window==null?void 0:window.navigator)==null?void 0:x.userAgent)==null?void 0:N.toLowerCase())==null?void 0:A.includes("windows"),q={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetGeoComplyLicense"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getGeoComplyLicense"}},{kind:"Field",name:{kind:"Name",value:"user"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CheckGeoLocation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"geoPacket"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"checkGeoLocation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"geoPacket"},value:{kind:"Variable",name:{kind:"Name",value:"geoPacket"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"geolocateIn"}}]}}]}}]};let l,m=!0,a;const j=async t=>{var o;try{const e=await M({load:{fetch},doc:T,variables:{geoPacket:t}});clearInterval(l),(o=e==null?void 0:e.checkGeoLocation)!=null&&o.geolocateIn?(l=setInterval(()=>{P()},e.checkGeoLocation.geolocateIn*1e3),F.next({type:"geocomply",subtype:"success"}),d.set(!0)):(d.set(!1),c("txtReason","Location failure"),s.next({type:"geocomply",error:{code:""}}),r.set(!1))}catch{}},B=()=>new Promise((t,o)=>{const e=document.createElement("script");document.head.append(e),e.onload=t,e.onerror=o,e.async=!0,e.src="https://stg-cdn.geocomply.com/190/gc-html5.js",e.type="text/javascript"}),H=t=>{var o;return(o=document.getElementById(t))==null?void 0:o.checked},O=t=>{var o;(o=window==null?void 0:window.GcHtml5)==null||o.startMyIpService({license:t,resumable:H("cbxResumable")})},U=()=>{var t;(t=window==null?void 0:window.GcHtml5)==null||t.stopMyIpService()},c=(t,o)=>{const e=document.getElementById(t);e&&e instanceof HTMLInputElement&&e&&(e.value=o??"")},P=async()=>{var t,o;try{const e=await M({load:{fetch},doc:q,variables:{}});e!=null&&e.getGeoComplyLicense&&(a=await((t=window==null?void 0:window.GcHtml5)==null?void 0:t.createClient()),a.events.on("abort",()=>{a.abort()}).on("engine.success",i=>{var n;m||(j(i),O(e.getGeoComplyLicense),c("txtLicense",e.getGeoComplyLicense),c("txtUserSessionId",(n=e==null?void 0:e.user)==null?void 0:n.id),c("txtReason","user login"))}).on("*.failed",i=>{r.set(!1),c("txtReason","failed at browser"),s.next({type:"geocomply",error:{code:i}})}).on("browser.success",()=>{m=!1}),a.setLicense(e.getGeoComplyLicense),a.setUserId(((o=e==null?void 0:e.user)==null?void 0:o.id)??""),a.request(),window.GcHtml5.onMyIpSuccess=async()=>{var n;H("cbxAckMyIPSuccess")&&((n=window==null?void 0:window.GcHtml5)==null||n.ackMyIPSuccess())},window.GcHtml5.onMyIpFailure=(i,n)=>{r.set(!1),c("txtReason","Ip failure"),s.next({type:"geocomply",error:{code:i,message:n}}),U()},R(()=>{clearInterval(l)}))}catch{}},oe=async()=>{try{V&&!("GcHtml5"in window)&&await B(),"GcHtml5"in window&&await P()}catch{s.next({type:"geocomply",error:{code:"600"}})}};export{Z as a,P as b,$ as c,ee as d,te as e,oe as f,r as g,d as h,_ as i};
