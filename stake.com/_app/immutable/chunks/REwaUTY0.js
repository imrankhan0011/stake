import{w as d}from"./mJIF3ZvJ.js";import{f as c}from"./BV84Ne7d.js";import{g as i}from"./Bhbbb5KL.js";function u(r){return async({cache:t,combine:n,load:s,variables:e})=>{r.store.update(o=>({...o,error:null,loading:!0}));try{const o=await c({doc:r.document,variables:{...r.previousVariables,...e},load:s,cache:t});if(o){const a=n(i(r.store).data,o);return r.store.update(l=>({...l,error:null,data:a})),a}else return r.store.update(a=>({...a,error:"Failed to fetch from server"})),null}catch{return null}finally{r.store.update(o=>({...o,loading:!1}))}}}function p(r){return async(t,n,s)=>{r.store.update(e=>({...e,error:null,loading:!0}));try{const e=await c({doc:r.document,variables:n,load:t,cache:s});r.previousVariables=n;const o=e;return r.store.update(a=>({...a,error:null,data:o})),o}catch(e){return r.store.update(o=>({...o,error:e})),null}finally{r.store.update(e=>({...e,loading:!1}))}}}function f(r){const t=d({loading:!1,error:null,data:null}),n={store:t,document:r,previousVariables:{}},s=u(n),e=p(n);return{...t,loadMore:s,fetch:e}}export{f as m};
