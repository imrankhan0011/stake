import{g as l}from"./Bhbbb5KL.js";import{p as d}from"./rq92GsuN.js";import{b as u}from"./BnZzCvUo.js";import{g as w}from"./CFyBPWZT.js";import{g as m}from"./Bh4jp7by.js";import{D as f}from"./DC8FEm5-.js";import{g as k}from"./CLgR3Pi3.js";import{i as p}from"./DRfdS80Y.js";import{s as g}from"./COyiceuV.js";const b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"TrackCampaignHit"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"code"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trackCampaignHit"},arguments:[{kind:"Argument",name:{kind:"Name",value:"code"},value:{kind:"Variable",name:{kind:"Name",value:"code"}}}]}]}}]},x=1e-8,i=u.namespace("affiliate"),v=()=>{var e;return i.has("code")?(e=i.get("code"))==null?void 0:e.code:void 0},_=()=>{var e;return i.has("clickId")?(e=i.get("clickId"))==null?void 0:e.clickId:void 0},A=async e=>{if(!e){i.set("clickId",{clickId:void 0});return}const t=Date.now()+f*15;i.set("clickId",{clickId:e,expiry:t})},E=async(e,t)=>{const o=w(),n=i.has("code")?Date.now()>i.get("code").expiry:!1,s=!(v()===e)&&!n,a=Date.now()+f*15;i.set("code",{code:e,expiry:a}),A(t),s&&await o.mutation(b,{code:e}).toPromise()},O=({host:e,campaignCode:t})=>`${e}/?c=${t}`,H=async({campaignName:e,campaignId:t})=>{const o=m(l(d).url.host),n=new Date,r=`${o}/download/campaign-data${t?`/${t}`:""}`,s=`Stake-affiliate-${e}_${n.toISOString()}.csv`,a=await fetch(r,{method:"GET",headers:{"Content-Type":"text/csv","x-access-token":k()||"",...p}});if(a.status!==200)throw new Error;const c=await a.blob();return g(c,s),a},M=async({campaignName:e,campaignId:t})=>{const o=m(l(d).url.host),n=new Date,r=`${o}/download/affiliate-user-data${t?`/${t}`:""}`,s=`Stake-affiliate-users-${e}_${n.toISOString()}.csv`,a=await fetch(r,{method:"GET",headers:{"Content-Type":"text/csv","x-access-token":k()||"",...p}});if(a.status!==200)throw new Error;const c=await a.blob();return g(c,s),a};export{x as M,M as a,_ as b,O as c,H as d,v as g,E as r};
