import{_ as l}from"./CMNPK1gw.js";import{a as B,o as F}from"./CQrL6g3R.js";import{ac as N,ab as q}from"./jOU3gvjy.js";import{d as C,g as I,w as u}from"./Bhbbb5KL.js";import{l as P}from"./DDtimXQG.js";import{i}from"./-2c5L_R-.js";import{b as D}from"./DRfdS80Y.js";function R(e){Object.keys(e).forEach(a=>{Object.keys(e[a]).forEach(r=>{P[a][r]=e[a][r]})})}const Y="storybookImmediatelyInvalidate",E={max:i._("Max"),required:i._("This field is required"),currency:i._("Currency"),default:i._("This field is not valid"),numberTooSmall:e=>({id:"The minimum value is {min}",values:e}),numberTooBig:e=>({id:"The maximum value is {max}",values:e}),stringTooShort:e=>({id:"Minimum character length is {min}",values:e}),stringTooLong:e=>({id:"Maximum character length is {max}",values:e}),emailInvalid:i._("This contains invalid email characters"),withdrawTo:i._("Address"),countryCode:i._("Country code"),phoneNumber:i._("Phone number"),optionalPhoneNumber:"Phone (Optional)",search:i._("Search"),noOptions:i._("No options found."),phoneMarketingSubscription:i._("By submitting your phone number, you are opting-in to receive marketing communications & offers via SMS from Stake.")},j={...E,withdrawTo:i._("Address")},K={stake:E,sweeps:j},k=K[D]||E,X={min:({min:e})=>({key:"stringTooShort",values:{min:e}}),max:({max:e})=>({key:"stringTooLong",values:{max:e}}),email:k.emailInvalid},z={min:({min:e})=>({key:"numberTooSmall",values:{min:e}}),max:({max:e})=>({key:"numberTooBig",values:{max:e}})},G={default:({label:e})=>({key:"default",values:{label:e}}),required:({label:e})=>({key:"required",values:{label:e}})},H=()=>{R({mixed:G,string:X,number:z})},p="@@form";function J(e){q(p,e)}function ne(){return N(p)}function L(e){var r,d;const a=(k==null?void 0:k[(r=e.message)==null?void 0:r.key])||e.message;return(d=e==null?void 0:e.message)!=null&&d.values&&typeof a=="function"?a(e.message.values):a}function Q({value:e,fieldKey:a,schema:r,getStores:d,transformValuesBeforeValidation:b,validateOptions:f}){const g=u(!1),V=u(e),h=u(!1),y=u(null),T=u([]),v=u(!1),S=u(!1);let _=e,m=e;const t=async()=>{var o;const s=d();if(s){const x=l.mapValues(s,w=>w.getValue());v.set(!0);try{return await r.validateAt(a,b(x),f),y.set(null),T.set([]),v.set(!1),null}catch(w){const M=w;if(y.set(L(M)),(f==null?void 0:f.abortEarly)===!1){const A=(o=M.inner)==null?void 0:o.map(O=>({message:L(O),path:O.path}));T.set(A)}return v.set(!1),M.message}}},n=V.subscribe(s=>{const o=I(h),x=I(S);_=s,o||h.set(s!==m),x&&t()}),c=g.subscribe(s=>{const o=I(h);!s&&o&&(S.set(!0),t())});return{touched:h,validating:v,value:V,error:y,innerErrors:T,focus:g,validateOnChange:S,validate:()=>t(),unsubscribe:()=>{n(),c()},reset:s=>{V.set(s||m)},getValue:()=>_,setInitialValue:s=>{m=s}}}function U(e){return e}function ie(e){let a;H();const r=(e==null?void 0:e.transformValuesBeforeValidation)||U,d=()=>a;a=l.mapValues(e.initialValues,(t,n)=>Q({value:t,fieldKey:n,schema:e.validationSchema,getStores:d,transformValuesBeforeValidation:r,validateOptions:e.validateOptions})),B(()=>{l.map(a,t=>t.unsubscribe())});const b=u(!1),f=async()=>{var c;if(b.set(!0),(await g()).every(s=>s===null)){const s=l.mapValues(a,o=>I(o.value));try{await e.onSubmit(s,m)}catch(o){console.error("handleSubmit",{e:o})}}else if(e.scrollToErrorOnSubmit){const s=(c=document.getElementsByClassName("input-error"))==null?void 0:c[0];s&&s.scrollIntoView({behavior:"smooth",block:"center"})}b.set(!1)},g=async()=>await Promise.all(l.values(l.mapValues(a,n=>n.validate()))),V=l.map(a,t=>t.error),h=u(!1),y=l.map(a,t=>t.validating),T=l.map(a,t=>t.touched),v=C(V,t=>!t.some(n=>n!==null)),S=C(y,t=>t.includes(!0)),_=C(T,t=>t.includes(!0)),m={fields:a,isValid:v,validating:S,touched:_,isSubmitting:b,disabled:h,handleSubmit:f,validate:g,reset:t=>{l.forEach(a,(n,c)=>{const s=t&&c in t?t[c]:e.initialValues[c];n.validateOnChange.set(!1),n.setInitialValue(s),n.value.set(s),n.touched.set(!1)})}};return J(m),N(Y)&&F(()=>{g()}),m}export{ie as c,ne as g,k as m,z as n};
